(self["webpackChunk_1kx_sourceCode"]=self["webpackChunk_1kx_sourceCode"]||[]).push([[384],{16312:function(e){e.exports={card:"card___X2t_w",label:"label___3kSJ9",value:"value___vPr4C",amount:"amount___28QoP",info:"info___3S3kZ",item:"item___EzhrT",arr:"arr___sG6wt",green:"green___Q3Bw_",red:"red___284AR",result_icon:"result_icon___1eoKk",container:"container___1bNK4",repay:"repay___3T4jn",borrow:"borrow___3omfj",error:"error___WlYKh",collateral:"collateral___2J7Qh",coll_title:"coll_title___3u7dq",panel:"panel___3Byw1",token:"token___3q3_M",incard_wrap:"incard_wrap___1-629",close:"close___kqqup"}},32636:function(e){e.exports={card:"card___29Y3U",label:"label___1BrRj",value:"value___1DY4V",amount:"amount___2pJtZ",info:"info___dacWO",item:"item___3Wexh",arr:"arr___2t7Ui",green:"green___2xwfj",red:"red___2TAuz",result_icon:"result_icon___20eKA",deposit:"deposit___1zH4d",remove:"remove___2pxJz",tooltip:"tooltip___1RT7R",container:"container___hG5-7"}},78129:function(e,n,t){"use strict";t.d(n,{Z:function(){return z}});t(71194);var a=t(37079),r=t(16312),s=t.n(r),o=t(89544),i=t(44512),c=(t(22385),t(59381)),l=t(8870),u=t(39428),d=t(3182),p=t(2824),h=t(86914),m=t(21512),x=t(3150),Z=t(67294),v=t(55902),k=t(6011),f=t(75899),_=t(39423),j=t(66996),b=t(73218),w=t(19186),y=t(68052),g=t(48521);function N(e){var n=(0,v.I0)(),t=e.currentWallet,a=e.walletChainId,r=e.currentToken,i=e.closeModal,N=e.tokenDatas,I=t||{},C=I.calcBorrowRiskRate,S=I.borrow,D=I.calcBorrowLimit,T=I.calcApr,F=(0,Z.useState)([{id:(new Date).getTime(),userAmount:"",token:"",amount:"0"}]),B=(0,p.Z)(F,2),A=B[0],P=B[1],L=(0,Z.useState)(""),O=(0,p.Z)(L,2),R=O[0],q=O[1],E=(0,Z.useState)("0"),W=(0,p.Z)(E,2),X=W[0],J=W[1],M=(0,Z.useState)(r),z=(0,p.Z)(M,2),$=z[0],H=z[1],K=(0,Z.useState)(!1),Q=(0,p.Z)(K,2),Y=Q[0],G=Q[1],U=(0,Z.useState)(!1),V=(0,p.Z)(U,2),ee=V[0],ne=V[1],te=(0,Z.useState)(""),ae=(0,p.Z)(te,2),re=ae[0],se=ae[1],oe=(0,Z.useState)(""),ie=(0,p.Z)(oe,2),ce=ie[0],le=ie[1],ue=(0,Z.useState)(!1),de=(0,p.Z)(ue,2),pe=de[0],he=de[1],me=0;function xe(e,n){return Ze.apply(this,arguments)}function Ze(){return Ze=(0,d.Z)((0,u.Z)().mark((function e(n,t){var a;return(0,u.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!pe){e.next=2;break}return e.abrupt("return");case 2:a=[...A],a[t].userAmount=n,A.forEach((e=>{if(e.token){var r=(0,x.xD)(e.token,N);a[t].tokenData=r,a[t].amount=(0,x.xo)(n,r.tokenDecimal)}})),P(a),(0,x.Ds)(ve,500)(a);case 7:case"end":return e.stop()}}),e)}))),Ze.apply(this,arguments)}function ve(){return ke.apply(this,arguments)}function ke(){return ke=(0,d.Z)((0,u.Z)().mark((function e(){var n,r,s,o,i=arguments;return(0,u.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=i.length>0&&void 0!==i[0]?i[0]:A,e.next=3,(0,x.bX)(t,a);case 3:if(r=e.sent,r){e.next=6;break}return e.abrupt("return");case 6:if($.tokenId){e.next=8;break}return e.abrupt("return");case 8:return he(!0),e.next=11,D(a,$,n);case 11:return s=e.sent,J(s),e.next=15,C({chainId:a,_indatas:n,tokenDatas:N,amountOut:R,outToken:$});case 15:o=e.sent,le(o),he(!1);case 18:case"end":return e.stop()}}),e)}))),ke.apply(this,arguments)}var fe=function(){var e=(0,d.Z)((0,u.Z)().mark((function e(){return(0,u.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n({type:"tokens/updatePrice"});case 2:n({type:"tokens/fetchPoolInfo"});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_e=e=>{se(e),ne(!0),fe()};function je(){return be.apply(this,arguments)}function be(){return be=(0,d.Z)((0,u.Z)().mark((function e(){var n,r;return(0,u.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,x.bX)(t,a);case 2:if(n=e.sent,n){e.next=5;break}return e.abrupt("return");case 5:return G(!0),e.next=8,S({chainId:a,inDatas:A,outToken:$,amountOut:R});case 8:r=e.sent,console.log(r),r.error?(0,w.y)(r.error):r.hash&&_e(r.hash),G(!1);case 12:case"end":return e.stop()}}),e)}))),be.apply(this,arguments)}(0,Z.useEffect)((()=>{ve()}),[1,$,R]);var we=()=>{P((e=>[...e,{id:(new Date).getTime(),userAmount:"",token:"",amount:"0"}]))},ye=e=>{var n=[...A];n.splice(e,1),P(n),ve(n)},ge=(e,n)=>{var t=[...A],a=t.findIndex((e=>e.token.toLowerCase()===n.tokenId.toLowerCase()));if(a>-1)return(0,w.y)("".concat(n.symbol," ").concat((0,h.Z)("already_selected")));var r=(0,x.xD)(n.tokenId,N);r&&(t[e]=(0,l.Z)((0,l.Z)({},t[e]),{},{token:n.tokenId,tokenData:r,amount:(0,x.xo)(t[e].userAmount||"0",r.tokenDecimal)}),P(t),ve(t))},Ne=()=>{ne(!1),i(),fe()};return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(k.g,{spinning:(N||[]).length<1||Y,children:(0,g.jsxs)("div",{className:s().container,children:[A.map(((e,n)=>{var t;return(0,g.jsxs)("div",{className:s().incard_wrap,children:[(0,g.jsx)(f.Z,{title:"".concat((0,h.Z)("pay"),"(").concat((0,h.Z)("collateral"),")"),amount:e.userAmount,priceType:"borrow",type:"borrow",onAmountChange:e=>xe((e||0).toString(),n),token:A[n].tokenData||{},onChangeToken:e=>ge(n,e),slider:(0,g.jsx)(j.Z,{amount:e.userAmount,onChange:e=>xe((e||0).toString(),n),max:(null===(t=A[n].tokenData)||void 0===t?void 0:t.userTokenBalance)||0})}),A.length>1&&(0,g.jsx)("div",{className:s().close,onClick:()=>ye(n),children:(0,g.jsx)(b.Z,{})})]},e.id)})),(0,g.jsx)("div",{className:s().arr,onClick:we,children:(0,g.jsx)(_.Z,{type:"icon-plus"})}),(0,g.jsx)(f.Z,{amount:R,onAmountChange:e=>q((e||0).toString()),token:$,onChangeToken:H,type:"borrow",left:(0,g.jsxs)("div",{onClick:()=>q(X.toString()),children:[(0,h.Z)("borrow_limit"),":"," ",(0,g.jsx)("span",{className:"primary",children:pe?o.m5:X})]}),right:(0,g.jsxs)("div",{children:[(0,h.Z)("borrowed"),": ",me]})}),(0,g.jsxs)("div",{className:s().info,children:[(0,g.jsxs)("div",{className:s().item,children:[(0,g.jsx)("div",{className:s().label,children:(0,h.Z)("apr")}),(0,g.jsxs)("div",{className:s().fee,children:[T($),"%"]})]}),(0,g.jsxs)("div",{className:s().item,children:[(0,g.jsx)("div",{className:s().label,style:{borderBottom:"1px dashed var(--primary-color)"},children:(0,g.jsx)(c.Z,{title:(0,h.Z)("risk_factor_tips"),children:(0,h.Z)("risk_factor")})}),(0,g.jsx)("div",{className:s().fee,children:pe?o.m5:ce})]})]}),(0,g.jsx)(m.Z,{height:50,align:"center",onClick:je,conditions:[{handle:!($.assets&&$.assets.updatedAt.gt(0)),txt:(0,h.Z)("cant_borrow")},{handle:parseFloat(R||"0")<=0&&parseFloat(A[0].userAmount||"0")<=0,txt:(0,h.Z)("input_amount")},{handle:(()=>{var e=!1;return A.forEach((n=>{n.token&&parseFloat(n.userAmount)>parseFloat(n.tokenData?n.tokenData.userTokenBalance:"0")&&(e=!0)})),e})(),txt:(0,h.Z)("lack_balance")},{handle:parseFloat(R||"0")>parseFloat(X||"0"),txt:(0,h.Z)("beyond")}],children:parseFloat(R||"0")<=0&&parseFloat(A[0].userAmount)>0?(0,h.Z)("add_collateral"):(0,h.Z)("borrow")})]})}),(0,g.jsx)(y.Z,{title:(0,h.Z)("deposit_done"),amountTitle:(0,h.Z)("deposited_amount"),txid:re,visible:ee,close:Ne,chainId:a,tokenIns:(()=>{var e=[];return A.forEach((n=>{e.push((0,l.Z)({amount:n.userAmount,tokenId:n.token},n.tokenData))})),e})(),tokenOuts:[(0,l.Z)((0,l.Z)({},$),{},{amount:R})]})]})}var I=e=>{var n=e.common,t=e.tokens,a=e.wallet;return(0,l.Z)((0,l.Z)((0,l.Z)({},n),t),a)},C=(0,v.$j)(I)(N),S=(t(77883),t(49747)),D=t(43856),T=t(40553),F=t(30359),B=t.n(F),A=(0,Z.lazy)((()=>t.e(373).then(t.bind(t,56373)).then((e=>{var n=e.default;return{default:(0,Z.forwardRef)(((e,t)=>(0,g.jsx)(n,(0,l.Z)({ref:t},e))))}})))),P=t(7230),L=t(55130);function O(e){var n=e.onAmountChange,t=e.amount,a=e.token,r=e.onChangeToken,s=e.left,o=e.right,i=e.title,c=e.rightBottom,l=e.type,u=void 0===l?"":l,d=e.className,p=e.slider,h=(0,Z.useRef)(null),m=e=>{null===n||void 0===n||n(e)};return(0,g.jsxs)("div",{className:"".concat(B().card," ").concat(d),onClick:e=>{(0,x.r3)(e.currentTarget,e.target)&&h.current.focus()},children:[(0,g.jsxs)("div",{className:B().label,children:[s||(0,g.jsxs)("div",{children:[i,":",(0,g.jsx)(Z.Suspense,{fallback:"loading",children:(0,g.jsx)(L.Z,{data:{amount:t,token:a}})})]})," ",o||(0,g.jsx)(P.F,{token:a,setFullAmount:e=>n(e),type:u})]}),(0,g.jsxs)("div",{className:B().value,children:[(0,g.jsx)(Z.Suspense,{fallback:"loading",children:(0,g.jsx)(A,{className:"inputTxt",amount:t,onChange:m,ref:h})}),c||(0,g.jsx)(T.Z,{currentToken:a,changeToken:r,type:u})]}),p]})}var R=O,q=t(33925),E=t(905),W=t(3987);function X(e){var n=(0,v.I0)(),t=e.currentToken,a=e.tokenDatas,r=e.walletChainId,o=e.currentWallet,i=e.account,f=e.closeModal,_=o||{},b=_.getBorrowContract,N=_.repay,I=_.calcApr,C=_.calcRepayRiskRate,T=b(r),F=(0,Z.useState)(t),B=(0,p.Z)(F,2),A=B[0],P=B[1],L=(0,x.FD)("0"),O=(0,p.Z)(L,2),X=O[0],J=O[1],M=(0,Z.useState)("0"),z=(0,p.Z)(M,2),$=z[0],H=z[1],K=(0,Z.useState)(!1),Q=(0,p.Z)(K,2),Y=Q[0],G=Q[1],U=(0,Z.useState)([]),V=(0,p.Z)(U,2),ee=V[0],ne=V[1],te=(0,Z.useState)(!1),ae=(0,p.Z)(te,2),re=ae[0],se=ae[1],oe=(0,Z.useState)(!1),ie=(0,p.Z)(oe,2),ce=ie[0],le=ie[1],ue=(0,Z.useState)(""),de=(0,p.Z)(ue,2),pe=de[0],he=de[1],me=(0,Z.useState)("1"),xe=(0,p.Z)(me,2),Ze=xe[0],ve=xe[1],ke=A.tokenId,fe=A.symbol,_e=(0,Z.useState)(!1),je=(0,p.Z)(_e,2),be=je[0],we=je[1];function ye(e){return ge.apply(this,arguments)}function ge(){return ge=(0,d.Z)((0,u.Z)().mark((function e(n){return(0,u.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:J(n),n&&H((0,x.xo)(n,A.tokenDecimal));case 2:case"end":return e.stop()}}),e)}))),ge.apply(this,arguments)}var Ne=function(){var e=(0,d.Z)((0,u.Z)().mark((function e(){return(0,u.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n({type:"tokens/updatePrice"});case 2:n({type:"tokens/fetchPoolInfo"});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ie=e=>{he(e),le(!0),Ne()};function Ce(){return Se.apply(this,arguments)}function Se(){return Se=(0,d.Z)((0,u.Z)().mark((function e(){var n,t;return(0,u.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,x.bX)(o,r);case 2:if(n=e.sent,n){e.next=5;break}return e.abrupt("return");case 5:return se(!0),e.next=8,N({chainId:r,tokenId:ke,tokenIn:A,amountInRaw:$,tokenOuts:ee});case 8:t=e.sent,console.log(t),t.error?(0,w.y)(t.error):t.hash&&Ie(t.hash),se(!1);case 12:case"end":return e.stop()}}),e)}))),Se.apply(this,arguments)}(0,Z.useEffect)((()=>{J("0"),H("0");var e=function(){var e=(0,d.Z)((0,u.Z)().mark((function e(){var n,t;return(0,u.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:we(!0),n=A.positions.collaterals,t=[],n=n.filter((e=>e.amount.gt(0))),n.forEach((e=>{var r=(0,x._u)(e.token.toLowerCase(),a);r&&e.amount&&t.push({token:r,max:(0,x.gB)(e.amount.toString(),r.tokenDecimal),amount:"",visible:1===n.length})})),ne(t),we(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[A]),(0,Z.useEffect)((()=>{if(!(ee.length<1)){var e=C({tokenIn:A,amountIn:X,tokenOuts:ee});ve(e)}}),[X,ee]);var De=()=>{le(!1),f(),Ne()},Te=parseFloat(Ze)>0,Fe=new E.Z(0);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(k.g,{spinning:a&&a.length<1||re,children:(0,g.jsxs)("div",{className:s().container,id:"J_repay",children:[(0,g.jsx)(R,{left:(0,g.jsxs)("div",{onClick:(0,d.Z)((0,u.Z)().mark((function e(){var n,t;return(0,u.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return J(parseFloat(A.userDebt)>parseFloat(A.userTokenBalance)?A.userTokenBalance:A.userDebt),e.next=3,(0,x.bX)(o,r);case 3:if(n=e.sent,n){e.next=6;break}return e.abrupt("return");case 6:if(!(parseFloat(A.userDebt)>parseFloat(A.userTokenBalance))){e.next=10;break}H(ke.tokenBalance),e.next=14;break;case 10:return e.next=12,T.getAccountDebt(ke,i,3600);case 12:t=e.sent,H(t);case 14:case"end":return e.stop()}}),e)}))),children:[(0,h.Z)("max_payable"),":"," ",(0,g.jsxs)("span",{className:"primary",children:[(0,g.jsx)(W.Z,{value:A.userDebt})," ",fe]})]}),right:(0,g.jsxs)("div",{onClick:(0,d.Z)((0,u.Z)().mark((function e(){var n;return(0,u.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(J(parseFloat(A.userDebt)>parseFloat(A.userTokenBalance)?A.userTokenBalance:A.userDebt),!(parseFloat(A.userDebt)>parseFloat(A.userTokenBalance))){e.next=5;break}H(ke.tokenBalance),e.next=9;break;case 5:return e.next=7,T.getAccountDebt(ke,i,3600);case 7:n=e.sent,H(n);case 9:case"end":return e.stop()}}),e)}))),children:[(0,h.Z)("balance"),":"," ",(0,g.jsx)("span",{className:"primary",children:(0,x.FH)(A.userTokenBalance,4)})]}),amount:X,onAmountChange:e=>ye(e),token:A,onChangeToken:e=>P(e),slider:(0,g.jsx)(j.Z,{amount:X.read(),onChange:e=>ye(e),max:A.userDebt})}),(0,g.jsxs)(k.g,{spinning:be,children:[ee.length>1&&(0,g.jsxs)("div",{className:s().collateral,children:[(0,g.jsxs)("div",{className:s().coll_title,children:[(0,g.jsxs)("div",{className:s().label,children:[(0,h.Z)("collateral"),":"]}),(0,g.jsx)("div",{className:s().arr,onClick:()=>G(!Y),style:{display:ee.length>0?"block":"none"},children:(0,g.jsx)(D.m6,{})})]}),(0,g.jsx)("div",{className:s().panel,style:{display:Y?"flex":"none"},children:ee.map(((e,n)=>(0,g.jsx)("div",{className:s().token,onClick:()=>{var e=[...ee];e[n].visible=!e[n].visible,ne(e)},children:(0,g.jsx)(q.Z,{data:e.token})},e.token.tokenId)))})]}),ee.map(((e,n)=>{var t=e.token,a=e.amount,r=e.max,o=e.visible;Fe=Fe.plus(a||0);var i=(0,x.B2)([{amount:a||0,token:t}],"borrow");return(0,g.jsxs)("div",{className:s().card,style:{display:o?"block":"none"},children:[(0,g.jsxs)("div",{className:s().label,children:[(0,g.jsxs)("div",{children:[(0,h.Z)("withdraw"),": $",(0,x.FH)(i,2)]}),(0,g.jsxs)("div",{onClick:()=>{var e=[...ee];e[n].amount=r,ne(e)},children:[(0,h.Z)("max_withdraw"),": ",(0,g.jsx)("span",{className:"primary",children:r})]})]}),(0,g.jsxs)("div",{className:s().value,children:[(0,g.jsx)("div",{className:s().amount,children:(0,g.jsx)(S.Z,{className:"inputTxt",value:a,min:0,max:r,onChange:e=>{var t=[...ee];t[n].amount=e,ne(t)}})}),(0,g.jsx)(q.Z,{data:t})]}),(0,g.jsx)(j.Z,{amount:a,onChange:e=>{var t=[...ee];t[n].amount=e,ne(t)},max:r})]},t.tokenId)}))]}),(0,g.jsxs)("div",{className:s().info,children:[(0,g.jsxs)("div",{className:s().item,children:[(0,g.jsx)("div",{className:s().label,children:(0,h.Z)("apr")}),(0,g.jsxs)("div",{className:s().fee,children:[I(A),"%"]})]}),(0,g.jsxs)("div",{className:s().item,children:[(0,g.jsx)("div",{className:s().label,children:(0,h.Z)("debt")}),(0,g.jsxs)("div",{className:s().fee,children:[A.userDebt," ",fe]})]}),(0,g.jsxs)("div",{className:s().item,children:[(0,g.jsx)("div",{className:s().label,style:{borderBottom:"1px dashed var(--primary-color)"},children:(0,g.jsx)(c.Z,{title:(0,h.Z)("risk_factor_tips"),children:(0,h.Z)("risk_factor")})}),(0,g.jsx)("div",{className:Te?s().fee:"".concat(s().fee," ").concat(s().error),children:"Infinity"===Ze?"--":Ze})]})]}),(0,g.jsxs)(m.Z,{height:50,align:"center",onClick:Ce,conditions:[{handle:A.debt.lte(0)&&A.totalCol.lte(0),txt:(0,h.Z)("no_debt")},{handle:Fe.plus(X.read()).lte(0),txt:(0,h.Z)("input_amount")},{handle:!fe,txt:(0,h.Z)("select_asset")},{handle:!Te,txt:(0,h.Z)("rf_above")}],className:Te?null:"wrong",children:[Fe.gt(0)&&parseFloat(X.read()||"0")>0&&"".concat((0,h.Z)("repay")," & ").concat((0,h.Z)("remove_coll")),Fe.lte(0)&&parseFloat(X.read()||"0")>0&&(0,h.Z)("repay"),Fe.gt(0)&&parseFloat(X.read()||"0")<=0&&(0,h.Z)("remove_coll")]})]})}),ce&&(0,g.jsx)(y.Z,{title:(0,h.Z)("repayment_success"),amountTitle:(0,h.Z)("repaid_debt"),receiveTitle:(0,h.Z)("received_coll"),txid:pe,chainId:r,visible:ce,close:De,tokenIn:(0,l.Z)((0,l.Z)({},A),{},{amount:X.read()}),tokenOuts:(()=>{var e=[];return ee.map((n=>{n.amount&&e.push((0,l.Z)({amount:n.amount.toString()},n.token))})),e})()})]})}var J=e=>{var n=e.common,t=e.tokens,a=e.wallet;return(0,l.Z)((0,l.Z)((0,l.Z)({},n),t),a)},M=(0,v.$j)(J)(X);function z(e){var n=e.showPanelIndex,t=e.setShowPanelIndex,r=e.currentToken;return(0,g.jsxs)(a.Z,{width:420,footer:null,visible:n>-1,getContainer:()=>document.getElementById("J_Page")||document.body,onCancel:()=>t(-1),closable:!1,wrapClassName:s().modal,children:[(0,g.jsx)(i.Z,{menuDatas:o.Tv,menuIndex:n,setMenuIndex:t}),(0,g.jsx)("div",{style:{display:0===n?"block":"none"},children:(0,g.jsx)(C,{currentToken:r,closeModal:()=>t(-1)})}),(0,g.jsx)("div",{style:{display:1===n?"block":"none"},children:(0,g.jsx)(M,{currentToken:r,closeModal:()=>t(-1)})})]})}},73167:function(e,n,t){"use strict";t.d(n,{A:function(){return i},b:function(){return c}});var a=t(16312),r=t.n(a),s=t(86914),o=t(48521),i=e=>{var n=e.setShowPanelIndex,t=e.txt;return(0,o.jsx)("span",{className:r().borrow,onClick:e=>{e.stopPropagation(),n(0)},children:t||(0,s.Z)("borrow")})},c=e=>{var n=e.setShowPanelIndex;return(0,o.jsx)("span",{className:r().repay,onClick:e=>{e.stopPropagation(),n(1)},children:(0,s.Z)("repay")})}},94530:function(e,n,t){"use strict";t.d(n,{Z:function(){return D}});t(71194);var a=t(37079),r=t(32636),s=t.n(r),o=t(44512),i=t(89544),c=t(8870),l=t(39428),u=t(3182),d=t(2824),p=t(86914),h=t(43856),m=t(21512),x=t(3150),Z=t(67294),v=t(55902),k=t(6011),f=t(75899),_=t(19186),j=t(68052),b=t(48521);function w(e){var n=(0,v.I0)(),t=e.walletChainId,a=e.tokenDatas,r=e.currentToken,o=e.close,w=e.currentWallet,y=w||{},g=y.calcAddLiqOut,N=y.addLiq,I=(0,Z.useState)(r.tokenId||(a[0]||{}).tokenId),C=(0,d.Z)(I,2),S=C[0],D=C[1],T=(0,Z.useState)(""),F=(0,d.Z)(T,2),B=F[0],A=F[1],P=(0,Z.useState)(""),L=(0,d.Z)(P,2),O=L[0],R=L[1],q=(0,Z.useState)("0"),E=(0,d.Z)(q,2),W=E[0],X=E[1],J=(0,Z.useState)(!1),M=(0,d.Z)(J,2),z=M[0],$=M[1],H=(0,Z.useState)(!1),K=(0,d.Z)(H,2),Q=K[0],Y=K[1],G=(0,Z.useState)(""),U=(0,d.Z)(G,2),V=U[0],ee=U[1],ne=(0,Z.useState)(!1),te=(0,d.Z)(ne,2),ae=te[0],re=te[1],se=S?(0,x.xD)(S,a):a[0];function oe(e){return ie.apply(this,arguments)}function ie(){return ie=(0,u.Z)((0,l.Z)().mark((function e(n){var a;return(0,l.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return A(n),e.next=3,(0,x.bX)(w,t);case 3:if(a=e.sent,a&&S){e.next=6;break}return e.abrupt("return");case 6:(0,x.Ds)(ce,500)(n);case 7:case"end":return e.stop()}}),e)}))),ie.apply(this,arguments)}function ce(e){return le.apply(this,arguments)}function le(){return le=(0,u.Z)((0,l.Z)().mark((function e(n){var a,r;return(0,l.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n){e.next=4;break}return R(""),X("0"),e.abrupt("return");case 4:return re(!0),a=(0,x.xo)(n||"0",se.tokenDecimal),e.next=8,g(t,S,a,se);case 8:r=e.sent,r.error?((0,_.y)(r.error),R(""),X("0")):r.amountOut&&(R(r.amountOut),X((0,x.FH)(r.increasedPoolShare,4))),re(!1);case 11:case"end":return e.stop()}}),e)}))),le.apply(this,arguments)}var ue=function(){var e=(0,u.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return ee(t),Y(!0),e.next=4,n({type:"tokens/updatePrice"});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();function de(){return pe.apply(this,arguments)}function pe(){return pe=(0,u.Z)((0,l.Z)().mark((function e(){var n,a,r;return(0,l.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,x.bX)(w,t);case 2:if(n=e.sent,n){e.next=5;break}return e.abrupt("return");case 5:return $(!0),a=(0,x.xo)(B||"0",se.tokenDecimal),e.next=9,N({tokenId:S,_amountRaw:a,chainId:t,amountRaw:a.toString()});case 9:r=e.sent,r.error?(0,_.y)(r.error):r.hash&&ue(r.hash),$(!1);case 12:case"end":return e.stop()}}),e)}))),pe.apply(this,arguments)}(0,Z.useEffect)((()=>{ce(B)}),[S]);var he=function(){var e=(0,u.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return Y(!1),o(),e.next=4,n({type:"tokens/updatePrice"});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.g,{spinning:a.length<1||z,children:(0,b.jsxs)("div",{className:s().container,children:[(0,b.jsx)(f.Z,{title:(0,p.Z)("pay"),amount:B,onAmountChange:e=>oe((e||"0").toString()),token:se,onChangeToken:e=>D(e.tokenId),type:"addLiq"}),(0,b.jsx)("div",{className:s().arr,children:(0,b.jsx)(h.We,{})}),(0,b.jsxs)("div",{className:s().card,children:[(0,b.jsxs)("div",{className:s().label,children:[(0,b.jsx)("div",{children:"".concat(se.symbol," ").concat((0,p.Z)("lptoken_receive"))}),(0,b.jsx)("div",{children:(0,p.Z)("increased_pool")})]}),(0,b.jsxs)("div",{className:s().value,children:[(0,b.jsx)("div",{className:s().amount,title:ae?"":O,children:ae?i.m5:O}),(0,b.jsx)("div",{style:{marginLeft:10},children:ae?i.m5:"".concat(W,"%")})]})]}),(0,b.jsx)(m.Z,{height:50,align:"center",onClick:de,conditions:[{handle:!S,txt:(0,p.Z)("select_asset")},{handle:parseFloat(B||"0")<=0,txt:(0,p.Z)("input_amount")}],children:(0,p.Z)("add_liquidity")})]})}),Q&&(0,b.jsx)(j.Z,{title:(0,p.Z)("deposit_done"),amountTitle:(0,p.Z)("deposited_amount"),txid:V,chainId:t,visible:Q,close:he,tokenIn:(0,c.Z)((0,c.Z)({},se),{},{amount:B}),tokenOuts:[{icon:null===se||void 0===se?void 0:se.iconLp,symbol:(null===se||void 0===se?void 0:se.symbol)||" LP",tokenId:null===se||void 0===se?void 0:se.liquidity,amount:O}]})]})}var y=e=>{var n=e.common,t=e.tokens,a=e.wallet;return(0,c.Z)((0,c.Z)((0,c.Z)({},n),t),a)},g=(0,v.$j)(y)(w),N=t(33925);function I(e){var n=(0,v.I0)(),t=e.walletChainId,a=e.currentToken,r=e.tokenDatas,o=e.close,w=e.currentWallet,y=e.osdTokenData,g=(0,Z.useState)(a.tokenId||(r[0]||{}).tokenId),I=(0,d.Z)(g,2),C=I[0],S=I[1],D=w||{},T=D.calcRemoveLiqIn,F=D.removeLiq,B=(0,Z.useState)(""),A=(0,d.Z)(B,2),P=A[0],L=A[1],O=(0,Z.useState)("0"),R=(0,d.Z)(O,2),q=R[0],E=R[1],W=(0,Z.useState)("0"),X=(0,d.Z)(W,2),J=X[0],M=X[1],z=(0,Z.useState)(!1),$=(0,d.Z)(z,2),H=$[0],K=$[1],Q=(0,Z.useState)(!1),Y=(0,d.Z)(Q,2),G=Y[0],U=Y[1],V=(0,Z.useState)(""),ee=(0,d.Z)(V,2),ne=ee[0],te=ee[1],ae=(0,Z.useState)(!1),re=(0,d.Z)(ae,2),se=re[0],oe=re[1],ie=(0,x.xD)(C,r);function ce(e){return le.apply(this,arguments)}function le(){return le=(0,u.Z)((0,l.Z)().mark((function e(n){var a;return(0,l.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return L(n),e.next=3,(0,x.bX)(w,t);case 3:if(a=e.sent,a&&C){e.next=6;break}return e.abrupt("return");case 6:(0,x.Ds)(ue,500)(n);case 7:case"end":return e.stop()}}),e)}))),le.apply(this,arguments)}function ue(e){return de.apply(this,arguments)}function de(){return de=(0,u.Z)((0,l.Z)().mark((function e(n){var a,r;return(0,l.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n){e.next=4;break}return E(""),M(""),e.abrupt("return");case 4:return oe(!0),a=(0,x.xo)(n||"0",ie.lpDecimal),e.next=8,T(t,C,a);case 8:r=e.sent,r.error?((0,_.y)(r.error),E(""),M("")):r.amountOutToken&&(E((0,x.gB)(r.amountOutToken,ie.tokenDecimal,8)),M((0,x.gB)(r.amountOutOsd,y.tokenDecimal,8))),oe(!1);case 11:case"end":return e.stop()}}),e)}))),de.apply(this,arguments)}var pe=function(){var e=(0,u.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return te(t),U(!0),e.next=4,n({type:"tokens/updatePrice"});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();function he(){return me.apply(this,arguments)}function me(){return me=(0,u.Z)((0,l.Z)().mark((function e(){var n,a,r;return(0,l.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,x.bX)(w,t);case 2:if(n=e.sent,n&&C){e.next=5;break}return e.abrupt("return");case 5:return a=(0,x.xo)(P||"0",ie.lpDecimal),K(!0),e.next=9,F({tokenId:C,_amountRaw:a,chainId:t,amountRaw:a.toString(),tokenObj:ie});case 9:r=e.sent,console.log(r),r.error?(0,_.y)(r.error):r.hash&&pe(r.hash),K(!1);case 13:case"end":return e.stop()}}),e)}))),me.apply(this,arguments)}(0,Z.useEffect)((()=>{ue(P)}),[C]);var xe=function(){var e=(0,u.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return U(!1),o(),e.next=4,n({type:"tokens/updatePrice"});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.g,{spinning:r.length<1||H,children:(0,b.jsxs)("div",{className:s().container,children:[(0,b.jsx)(f.Z,{left:(0,b.jsxs)("div",{children:[(0,p.Z)("burn_pool_share"),":"]}),amount:P,onAmountChange:e=>ce(e),type:"lp",token:ie,onChangeToken:e=>S(e.tokenId)}),(0,b.jsx)("div",{className:s().arr,children:(0,b.jsx)(h.We,{})}),(0,b.jsxs)("div",{className:s().card,children:[(0,b.jsx)("div",{className:s().label,children:(0,b.jsxs)("div",{children:[(0,p.Z)("receive"),":"]})}),(0,b.jsxs)("div",{className:s().value,children:[(0,b.jsx)("div",{className:s().amount,children:se?i.m5:q}),(0,b.jsx)(N.Z,{data:ie})]}),(0,b.jsxs)("div",{className:s().value,children:[(0,b.jsx)("div",{className:s().amount,children:se?i.m5:J}),(0,b.jsx)(N.Z,{data:y})]})]}),(0,b.jsx)(m.Z,{height:50,align:"center",onClick:he,conditions:[{handle:!C,txt:(0,p.Z)("select_asset")},{handle:!(ie.userLpBalance&&parseFloat(ie.userLpBalance)>0),txt:(0,p.Z)("no_lpbalance")},{handle:parseFloat(P||"0")<=0,txt:(0,p.Z)("input_amount")},{handle:parseFloat(P||"0")>parseFloat(ie.userLpBalance||"0"),txt:(0,p.Z)("lack_balance")}],children:(0,p.Z)("remove_liquidity")})]})}),G&&(0,b.jsx)(j.Z,{title:(0,p.Z)("liq_remove_done"),amountTitle:(0,p.Z)("burned"),txid:ne,chainId:t,visible:G,close:xe,tokenIn:{icon:null===ie||void 0===ie?void 0:ie.iconLp,symbol:(null===ie||void 0===ie?void 0:ie.symbol)||" LP",tokenId:null===ie||void 0===ie?void 0:ie.liquidity,amount:P},tokenOuts:[(0,c.Z)((0,c.Z)({},ie),{},{amount:q}),(0,c.Z)((0,c.Z)({},y),{},{amount:J})]})]})}var C=e=>{var n=e.common,t=e.tokens,a=e.wallet;return(0,c.Z)((0,c.Z)((0,c.Z)({},n),t),a)},S=(0,v.$j)(C)(I);function D(e){var n=e.showPanelIndex,t=e.setShowPanelIndex,r=e.currentToken;return(0,b.jsxs)(a.Z,{width:420,footer:null,visible:n>-1,getContainer:()=>document.getElementById("J_Page")||document.body,onCancel:()=>t(-1),closable:!1,wrapClassName:s().modal,children:[(0,b.jsx)(o.Z,{menuDatas:i.wg,menuIndex:n,setMenuIndex:t}),(0,b.jsx)("div",{style:{display:0===n?"block":"none"},children:(0,b.jsx)(g,{currentToken:r,close:()=>t(-1)})}),(0,b.jsx)("div",{style:{display:1===n?"block":"none"},children:(0,b.jsx)(S,{currentToken:r,close:()=>t(-1)})})]})}}}]);